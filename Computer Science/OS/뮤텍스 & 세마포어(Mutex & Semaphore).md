# 뮤텍스 & 세마포어(Mutex & Semaphore)

## 뮤텍스와 세마포어의 배경
```
여러 프로세스/스레드가 공유 자원에 동시에 접근하면 동시성 문제(경쟁 상태, 데이터 불일치)가 발생할 수 있음. 이를 방지하기 위해 프로세스/스레드 간의 동기화가 필요
```

<br>

## 뮤텍스(Mutual Exclusion, 상호 배제)
```
단일 스레드만 공유 자원에 접근 가능하도록 제어하며, 소유한 스레드만 잠금 해제가 가능
```

<img src="https://velog.velcdn.com/images/abcdana/post/b55cc4a4-2202-4109-b4af-1ad0c388ff9a/image.png">

### 특징
- 잠금(Lock)과 해제(Unlock)를 통해 동작

- 한 번에 단일 사용자만 자원에 접근 가능

- **boolean**을 통해 잠금/해제 설정

- 소유 개념 : 잠금(Lock)을 획득한 스레드만 해제(Unlock) 가능

<br>

### 장점
- 자원에 대한 **독점적 접근 보장**

- **간단한 구현**과 관리

<br>

### 단점
- 잘못된 구현 시 **데드락(Deadlock)** 발생 가능

- 소유 스레드가 해제하지 않으면 다른 스레드가 자원에 접근 불가

<br>

## 세마포어(Semaphore)
```
동시 접근 가능한 프로세스/스레드의 수를 제한하며, 카운터 기반으로 작동
```

<img src="https://media.geeksforgeeks.org/wp-content/uploads/20241015130721027935/Semaphore.png">

<br>

### 특징
- **카운터 기반**: 초기값을 설정하여 동시 접근 가능한 스레드의 수를 제어

- 초기값이 1인 경우, 뮤텍스와 유사한 동작 수행

- 카운터가 0이면 자원이 모두 사용 중이며, 접근하려는 스레드는 대기

- 소유 개념 없음: **어떤 스레드도 해제 가능**

<br>

### 종류
- **이진 세마포어(Binary Semaphore)**: 값이 0 또는 1로 제한됨. (뮤텍스와 유사)

- **카운팅 세마포어(Counting Semaphore)**: 카운터 값이 1 이상으로 설정 가능

<br>

### 동작 방식
- **P(Wait) 연산**: 자원 접근 시 카운터 값을 감소. 카운터가 0이면 자원이 모두 사용 중이므로 대기.

- **V(Signal) 연산**: 자원 사용 종료 후 카운터 값을 증가시켜 대기 중인 스레드/프로세스가 자원에 접근할 수 있도록 함.

```
카운트 <= 0 시, 절댓값은 대기 중인 프로세스의 수를 의미
```

<br>

### 장점
- 다수의 사용자가 공유 자원에 접근하도록 제한 가능

<br>

### 단점
- 잘못된 구현 시 데드락(Deadlock) 또는 우선순위 역전(Priority Inversion) 발생 가능

```
우선순위 역전(Priority Inversion)란, 우선순위가 높은 프로세스가 우선순위가 낮은 프로세스 때문에 실행되지 못하는 상황
```